//Image enchancement Technique

# Histogram Equalized
import cv2
import matplotlib.pyplot as plt

img=cv2.imread("/content/front_face.jpg",0)
he_img=cv2.equalizeHist(img)

plt.figure(figsize=(12,5))
plt.subplot(1,3,1)
plt.title("Original")
plt.imshow(img)
plt.axis("off")

plt.subplot(1,3,2)
plt.title("Histogram Equalized")
plt.imshow(he_img)
plt.axis("off")

plt.subplot(1,3,3)
plt.title("Histogram Equalization")
plt.hist(he_img.ravel(),bins=256)
plt.show()

#clahe

import cv2
import matplotlib.pyplot as plt

# Load original image in grayscale
img = cv2.imread("/content/elephant.jpg", 0)

clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8,8))
clahe_img = clahe.apply(img)

plt.figure(figsize=(12,5))

plt.subplot(1,2,1)
plt.title("Original")
plt.imshow(img, cmap='gray', vmin=0, vmax=255)   # TRUE grayscale
plt.axis("off")

plt.subplot(1,2,2)
plt.title("CLAHE Enhanced")
plt.imshow(clahe_img, cmap='gray', vmin=0, vmax=255)  # TRUE grayscale
plt.axis("off")

plt.show()

#COLOR ENHANCED

import cv2
import matplotlib.pyplot as plt
img =cv2.imread("/content/zoo.jpg")
img_ycrcb=cv2.cvtColor(img,cv2.COLOR_BGR2YCrCb)
Y,Cr,Cb =cv2.split(img_ycrcb)
clahe=cv2.createCLAHE(clipLimit=2.5,tileGridSize=(8,8))
Y_clahe=clahe.apply(Y)
img_clahe=cv2.merge((Y_clahe,Cr,Cb))
img_clahe=cv2.cvtColor(img_clahe,cv2.COLOR_YCrCb2BGR)
plt.figure(figsize=(12,5))
plt.subplot(1,2,1)
plt.title("Original")
plt.imshow(cv2.cvtColor(img,cv2.COLOR_BGR2RGB))
plt.axis("off")
plt.subplot(1,2,2)
plt.title("COLOR ENHANCED")
plt.imshow(cv2.cvtColor(img_clahe,cv2.COLOR_BGR2RGB))
plt.axis("off")
plt.show()

#spatial domain filter - smoothing
import cv2
import matplotlib.pyplot as plt

#3 images loading
img_avg = cv2.imread("/content/sample_data/brick wall pic.webp")
img_gauss = cv2.imread("/content/sample_data/labubu.jpg")
img_median = cv2.imread("/content/sample_data/median image.jpeg")


#check loading
if img_avg is None or img_gauss is None or img_median is None:
  print("Error:one or more images not found.check file paths!")
  exit()

#convert BGR -> RGB for correct display
img_avg_rgb = cv2.cvtColor(img_avg,cv2.COLOR_BGR2RGB)
img_gauss_rgb = cv2.cvtColor(img_gauss,cv2.COLOR_BGR2RGB)
img_median_rgb = cv2.cvtColor(img_median,cv2.COLOR_BGR2RGB)

#apply filters

#1. Average Smoothing
avg_blur = cv2.blur(img_avg,(15,15))
avg_blur_rgb = cv2.cvtColor(avg_blur,cv2.COLOR_BGR2RGB)

#2. Gaussian Smoothing
gaussian_blur = cv2.GaussianBlur(img_gauss,(15,15),0)
gussian_blur_rgb = cv2.cvtColor(gaussian_blur,cv2.COLOR_BGR2RGB)

#3. Median Smoothing
median_blur = cv2.medianBlur(img_median,5)
median_blur_rgb = cv2.cvtColor(median_blur,cv2.COLOR_BGR2RGB)

#display before and after
plt.figure(figsize=(14,10))
#average blur
plt.subplot(3,2,1)
plt.imshow(img_avg_rgb)
plt.title("Original Image")
plt.axis('off')
plt.subplot(3,2,2)
plt.imshow(avg_blur_rgb)
plt.title("After Average Blur")
plt.axis('off')

#gaussian blur
plt.subplot(3,2,3)
plt.imshow(img_gauss_rgb)
plt.title("Original Image")
plt.axis('off')
plt.subplot(3,2,4)
plt.imshow(gussian_blur_rgb)
plt.title("After Gaussian Blur")
plt.axis('off')

#median blur
plt.subplot(3,2,5)
plt.imshow(img_median_rgb)
plt.title("Original Image")
plt.axis('off')
plt.subplot(3,2,6)
plt.imshow(median_blur_rgb)
plt.title("After Median Blur")
plt.axis('off')
plt.tight_layout()
plt.show()


#sharphing
import cv2
import matplotlib.pyplot as plt
import numpy as np

#load grayscale image
img = cv2.imread("/content/sample_data/gray scale image.jpg",0)

#sharping kernal(3 x 3)
kernel = np.array([[-1, -1, -1],
                   [-1,  9, -1],
                   [-1, -1, -1]])
#apply sharpening
sharpened = cv2.filter2D(img,-1,kernel)

#show original and sharpened images
plt.figure(figsize=(10,5))
plt.subplot(1,2,1)
plt.imshow(img,cmap='gray')
plt.title("Original Image")
plt.axis('off')
plt.subplot(1,2,2)
plt.imshow(sharpened,cmap='gray')
plt.title("Sharpened Image")
plt.axis('off')
plt.show()

# Spatial Domain Filtering
# Edge Detection

import cv2
import matplotlib.pyplot as plt

# Load image (grayscale)
img = cv2.imread("/content/gray scale image.jpg", 0)

# 1. Sobel Edge Detection
sobel_x = cv2.Sobel(img, cv2.CV_64F, 1, 0, ksize=3)  # Vertical edges
sobel_y = cv2.Sobel(img, cv2.CV_64F, 0, 1, ksize=3)  # Horizontal edges
sobel_xy = cv2.magnitude(sobel_x, sobel_y)

# 2. Canny Edge Detector
canny_edges = cv2.Canny(img, 100, 200)

# Display results
plt.figure(figsize=(12, 6))

plt.subplot(2, 2, 1)
plt.title("Original")
plt.imshow(img, cmap='gray')
plt.axis('off')

plt.subplot(2, 2, 2)
plt.title("Sobel X + Y")
plt.imshow(sobel_xy, cmap='gray')
plt.axis('off')

plt.subplot(2, 2, 3)
plt.title("Canny Edge Detection")
plt.imshow(canny_edges, cmap='gray')
plt.axis('off')

plt.show()
